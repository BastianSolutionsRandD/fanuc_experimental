<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro">
  <xacro:include filename="$(find fanuc_resources)/urdf/common_materials.xacro"/>

  <xacro:include filename="$(find fanuc_lrmate200id_support)/urdf/lrmate200id7l.transmission.xacro" />

  <xacro:macro name="cylinder_inertial" params="radius length mass *origin">
        <inertial>
            <mass value="${mass}" />
            <xacro:insert_block name="origin" />
            <inertia ixx="${0.0833333 * mass * (3 * radius * radius + length * length)}" ixy="0.0" ixz="0.0"
            iyy="${0.0833333 * mass * (3 * radius * radius + length * length)}" iyz="0.0"
            izz="${0.5 * mass * radius * radius}" />
        </inertial>
    </xacro:macro>
    <xacro:macro name="fanuc_lrmate200id7l" params="prefix">
    <xacro:property name="base_mass" value="4.0" />
    <xacro:property name="shoulder_mass" value="3.7000" />
    <xacro:property name="upper_arm_mass" value="8.3930" />
    <xacro:property name="forearm_mass" value="2.2750" />
    <xacro:property name="wrist_1_mass" value="1.2190" />
    <xacro:property name="wrist_2_mass" value="1.2190" />
    <xacro:property name="wrist_3_mass" value="0.1879" />

      <!-- links: main serial chain -->
      <link name="${prefix}base_link">
        <visual>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id/visual/base_link.stl"/>
          </geometry>
          <xacro:material_fanuc_gray28 />
        </visual>
        <collision>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id/collision/base_link.stl"/>
          </geometry>
        </collision>
        <xacro:cylinder_inertial radius="0.06" length="0.05" mass="${base_mass}">
            <origin xyz="0.0 0.0 0.0" rpy="0 0 0" />
        </xacro:cylinder_inertial>
      </link>
      <link name="${prefix}link_1">
        <visual>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id/visual/link_1.stl"/>
          </geometry>
          <xacro:material_fanuc_yellow />
        </visual>
        <collision>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id/collision/link_1.stl"/>
          </geometry>
        </collision>
        <xacro:cylinder_inertial radius="0.06" length="0.15" mass="${shoulder_mass}">
            <origin xyz="0.0 0.0 0.0" rpy="0 0 0" />
        </xacro:cylinder_inertial>
      </link>
      <link name="${prefix}link_2">
        <visual>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id7l/visual/link_2.stl"/>
          </geometry>
          <xacro:material_fanuc_yellow />
        </visual>
        <collision>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id7l/collision/link_2.stl"/>
          </geometry>
        </collision>
        <xacro:cylinder_inertial radius="0.06" length="0.56" mass="${upper_arm_mass}">
            <origin xyz="0.0 0.0 0.28" rpy="0 0 0" />
        </xacro:cylinder_inertial>
      </link>
      <link name="${prefix}link_3">
        <visual>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id/visual/link_3.stl"/>
          </geometry>
          <xacro:material_fanuc_yellow />
        </visual>
        <collision>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id/collision/link_3.stl"/>
          </geometry>
        </collision>
        <xacro:cylinder_inertial radius="0.06" length="0.5" mass="${forearm_mass}">
            <origin xyz="0.0 0.0 0.25" rpy="0 0 0" />
        </xacro:cylinder_inertial>
      </link>
      <link name="${prefix}link_4">
        <visual>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id7l/visual/link_4.stl"/>
          </geometry>
          <xacro:material_fanuc_yellow />
        </visual>
        <collision>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id7l/collision/link_4.stl"/>
          </geometry>
        </collision>
        <xacro:cylinder_inertial radius="0.6" length="0.12" mass="${wrist_1_mass}">
            <origin xyz="0.0 0.0 0.0" rpy="0 0 0" />
        </xacro:cylinder_inertial>
      </link>
      <link name="${prefix}link_5">
        <visual>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id/visual/link_5.stl"/>
          </geometry>
          <xacro:material_fanuc_yellow />
        </visual>
        <collision>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id/collision/link_5.stl"/>
          </geometry>
        </collision>
        <xacro:cylinder_inertial radius="0.6" length="0.12" mass="${wrist_2_mass}">
            <origin xyz="0.0 0.0 0.0" rpy="0 0 0" />
        </xacro:cylinder_inertial>
      </link>
      <link name="${prefix}link_6">
        <visual>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id/visual/link_6.stl"/>
          </geometry>
          <xacro:material_fanuc_black />
        </visual>
        <collision>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://fanuc_lrmate200id_support/meshes/lrmate200id/collision/link_6.stl"/>
          </geometry>
        </collision>
        <xacro:cylinder_inertial radius="0.6" length="0.12" mass="${wrist_3_mass}">
            <origin xyz="0.0 0.0 0.0" rpy="0 0 0" />
        </xacro:cylinder_inertial>
      </link>

      <!-- joints: main serial chain -->
      <joint name="${prefix}joint_1" type="revolute">
        <origin xyz="0 0 0.330" rpy="0 0 0" />
        <parent link="${prefix}base_link" />
        <child link="${prefix}link_1" />
        <axis xyz="0 0 1" />
        <limit effort="100" lower="${radians(-170)}" upper="${radians(170)}" velocity="2.96" />
      </joint>
      <joint name="${prefix}joint_2" type="revolute">
        <origin xyz="0.050 0 0" rpy="0 0 0"/>
        <parent link="${prefix}link_1" />
        <child link="${prefix}link_2" />
        <axis xyz="0 1 0" />
        <limit effort="100" lower="${radians(-100)}" upper="${radians(145)}" velocity="2.96" />
      </joint>
      <joint name="${prefix}joint_3" type="revolute">
        <origin xyz="0 0 0.440" rpy="0 0 0"/>
        <parent link="${prefix}link_2" />
        <child link="${prefix}link_3" />
        <axis xyz="0 -1 0" />
        <limit effort="100" lower="${radians(-70)}" upper="${radians(213)}" velocity="2.96" />
      </joint>
      <joint name="${prefix}joint_4" type="revolute">
        <origin xyz="0 0 0.035" rpy="0 0 0"/>
        <parent link="${prefix}link_3"/>
        <child link="${prefix}link_4"/>
        <axis xyz="-1 0 0"/>
        <limit effort="100" lower="${radians(-190)}" upper="${radians(190)}" velocity="3.48" />
      </joint>
      <joint name="${prefix}joint_5" type="revolute">
        <origin xyz="0.420 0 0" rpy="0 0 0"/>
        <parent link="${prefix}link_4"/>
        <child link="${prefix}link_5"/>
        <axis xyz="0 -1 0"/>
        <limit effort="100" lower="${radians(-125)}" upper="${radians(125)}" velocity="3.48" />
      </joint>
      <joint name="${prefix}joint_6" type="revolute">
        <origin xyz="0.080 0 0" rpy="0 0 0"/>
        <parent link="${prefix}link_5"/>
        <child link="${prefix}link_6"/>
        <axis xyz="-1 0 0"/>
        <limit effort="100" lower="${radians(-360)}" upper="${radians(360)}" velocity="6.97" />
      </joint>

      <!-- ROS-Industrial 'base' frame: base_link to Fanuc World Coordinates transform -->
      <link name="${prefix}base" />
      <joint name="${prefix}base_link-base" type="fixed">
        <origin xyz="0 0 0.330" rpy="0 0 0"/>
        <parent link="${prefix}base_link"/>
        <child link="${prefix}base"/>
      </joint>

      <!-- ROS-Industrial 'flange' frame: attachment point for EEF models -->
      <link name="${prefix}flange" />
      <joint name="${prefix}link_6-flange" type="fixed">
        <origin xyz="0 0 0" rpy="0 0 0" />
        <parent link="${prefix}link_6" />
        <child link="${prefix}flange" />
      </joint>

      <!-- ROS-Industrial 'tool0' frame: all-zeros tool frame -->
      <link name="${prefix}tool0" />
      <joint name="${prefix}flange-tool0" type="fixed">
        <origin xyz="0 0 0" rpy="${pi} ${-pi/2.0} 0" />
        <parent link="${prefix}flange" />
        <child link="${prefix}tool0" />
      </joint>
    </xacro:macro>
  </robot>
